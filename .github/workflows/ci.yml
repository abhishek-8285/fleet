name: Fleet Ultimate CI
on: [push, pull_request]

jobs:
  secure-check:
    runs-on: self-hosted
    steps:
      - name: üì• Checkout Code
        uses: actions/checkout@v4

      # 1. SECURITY SCAN (Trivy - Already installed on host)
      - name: üõ°Ô∏è Security & Secret Scan
        run: |
          echo "Running Professional Security Audit..."
          # Trivy is pre-installed in /usr/local/bin by admin
          trivy fs . \
            --scanners vuln,secret \
            --exit-code 1 \
            --severity CRITICAL,HIGH \
            --hide-progress \
            --format table
